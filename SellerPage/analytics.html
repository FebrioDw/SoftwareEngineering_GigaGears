<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GigaGears — Analytics & Report</title>

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- App CSS -->
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div class="container-fluid">
  <div class="row g-0">
    <!-- ===== SIDEBAR ===== -->
    <aside class="col-12 col-lg-2 side d-none d-lg-block">
      <a href="dashboard.html" class="brand-link" aria-label="GigaGears">
        <img src="../assets/gigagears-logo.png" alt="GigaGears" class="brand-logo">
      </a>

      <nav class="nav flex-column nav-gg">
        <a class="nav-link" href="dashboard.html"><i class="bi bi-grid-1x2"></i>Dashboard</a>
        <a class="nav-link" href="order.html"><i class="bi bi-bag"></i>Order</a>
        <a class="nav-link" href="product.html"><i class="bi bi-box"></i>Products</a>
        <a class="nav-link" href="balance.html"><i class="bi bi-wallet2"></i>Balance & Withdraw</a>
        <a class="nav-link active" href="analytics.html"><i class="bi bi-bar-chart"></i>Analytics & Report</a>
        <a class="nav-link" href="inbox.html"><i class="bi bi-inbox"></i>Inbox</a>
        <hr>
        <a class="nav-link" href="settings.html"><i class="bi bi-gear"></i>Settings</a>
      </nav>

      <div class="mt-4">
        <button class="btn btn-outline-danger w-100"><i class="bi bi-box-arrow-right me-1"></i> Log Out</button>
      </div>
    </aside>

    <!-- ===== MAIN ===== -->
    <main class="col-12 col-lg-10 main-wrap">
      <!-- App Bar -->
      <div class="appbar px-3 px-md-4 py-3 mb-4 d-flex align-items-center justify-content-between">
        <div>
          <div class="small opacity-75 mb-1">Track your store performance</div>
          <h1 class="wc-title mb-0">Reports & Analytics</h1>
        </div>
        <div class="d-flex gap-2">
          <span class="badge-chip d-inline-flex align-items-center gap-2"><i class="bi bi-bell"></i></span>
          <span class="badge-chip d-inline-flex align-items-center gap-2">
            <span class="rounded-circle bg-white text-primary fw-bold d-inline-flex align-items-center justify-content-center" style="width:28px;height:28px">TW</span>
            Admin
          </span>
        </div>
      </div>

      <!-- Filters -->
      <section class="gg-card p-3 p-md-4 mb-3">
        <div class="row g-2 align-items-center">
          <div class="col-12 col-md">
            <div class="input-group">
              <span class="input-group-text bg-transparent"><i class="bi bi-calendar-event"></i></span>
              <input id="dateRange" type="text" class="form-control" placeholder="Date Range" value="">
            </div>
          </div>
          <div class="col-6 col-md-3 col-lg-2">
            <select id="monthSelect" class="form-select">
              <option value="0">January</option><option value="1">February</option><option value="2">March</option>
              <option value="3">April</option><option value="4">May</option><option value="5">June</option>
              <option value="6">July</option><option value="7">August</option><option value="8" selected>September</option>
              <option value="9">October</option><option value="10">November</option><option value="11">December</option>
            </select>
          </div>
          <div class="col-6 col-md-3 col-lg-2 text-md-end">
            <button id="btnExport" class="btn btn-warning w-100"><i class="bi bi-download me-1"></i>Export Data</button>
          </div>
        </div>
      </section>

      <!-- KPI Cards -->
      <section class="row g-3 mb-3">
        <div class="col-12 col-md-6 col-xl-3">
          <div class="gg-card p-3 text-center">
            <div class="small text-muted-gg mb-1">Total Revenue (This Month)</div>
            <div id="kpiRevenue" class="fs-1 fw-black">$5,320</div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
          <div class="gg-card p-3 text-center">
            <div class="small text-muted-gg mb-1">Total Orders</div>
            <div id="kpiOrders" class="fs-1 fw-black">220</div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
          <div class="gg-card p-3 text-center">
            <div class="small text-muted-gg mb-1">Products Sold</div>
            <div id="kpiSold" class="fs-1 fw-black">640</div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-xl-3">
          <div class="gg-card p-3 text-center">
            <div class="small text-muted-gg mb-1">New Customers</div>
            <div id="kpiCustomers" class="fs-1 fw-black">75</div>
          </div>
        </div>
      </section>

      <!-- Orders Over Time -->
      <section class="gg-card p-3 p-md-4 mb-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0">Orders Over Time</h5>
          <small class="text-muted">This Month</small>
        </div>
        <canvas id="ordersChart" height="120"></canvas>
      </section>

      <!-- Bottom row: Best-Selling & Top Customer -->
      <section class="row g-3 mb-3">
        <div class="col-12 col-xl-8">
          <div class="gg-card p-3 p-md-4 h-100">
            <h5 class="mb-3">Best-Selling Products</h5>
            <div class="row g-3">
              <div class="col-12 col-md-5">
                <canvas id="bestPie" height="220"></canvas>
              </div>
              <div class="col-12 col-md-7">
                <div class="table-responsive">
                  <table class="table mb-0 align-middle">
                    <thead class="table-light">
                      <tr><th>Product</th><th class="text-end" style="width:120px">Units</th></tr>
                    </thead>
                    <tbody id="bestList">
                      <!-- diisi via JS -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12 col-xl-4">
          <div class="gg-card p-3 p-md-4 h-100">
            <h5 class="mb-3">Top Customer</h5>
            <ul id="topCustomer" class="list-unstyled m-0">
              <!-- diisi via JS -->
            </ul>
          </div>
        </div>
      </section>

      <p class="text-center mt-4 foot small mb-0">© 2025 GigaGears. All rights reserved.</p>
    </main>
  </div>
</div>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

<script>
(() => {
  // ===== Dummy dataset per bulan (index 0..11) =====
  const monthly = {
    8: { // September
      kpi: { revenue: 5320, orders: 220, sold: 640, customers: 75 },
      ordersByDay: [80,120,150,210,130,95,140,110,180,95,70,120,90,210,75,55,105,170,190,160,120,150,100,130,90,145,175,200,160,140],
      best: [
        {name:'Logitech G Pro X Headset', units:120},
        {name:'Razer BlackWidow V3 Keyboard', units:80},
        {name:'Corsair Gaming Mouse', units:55},
        {name:'Samsung 27" Gaming Monitor', units:40},
        {name:'Steam Gift Card $50', units:50},
        {name:'Kingston NVMe SSD 1TB', units:65},
      ],
      topCustomers: [
        {name:'Andi Pratama', orders:15, spend:1200},
        {name:'Nadia S', orders:13, spend:1120},
        {name:'Kevin T', orders:12, spend:1020},
      ]
    }
  };

  const fmtCur = n => '$' + Number(n).toLocaleString(undefined, {maximumFractionDigits:0});
  const byMonth = m => monthly[m] || monthly[8];

  // ====== Init KPI ======
  function renderKPI(m){
    const k = byMonth(m).kpi;
    document.getElementById('kpiRevenue').textContent   = fmtCur(k.revenue);
    document.getElementById('kpiOrders').textContent    = k.orders;
    document.getElementById('kpiSold').textContent      = k.sold;
    document.getElementById('kpiCustomers').textContent = k.customers;
  }

  // ====== Orders Chart ======
  const days = Array.from({length:30}, (_,i)=> String(i+1).padStart(2,'0'));
  const ctxOrders = document.getElementById('ordersChart');
  let ordersChart = null;

  function renderOrdersChart(m){
    const data = byMonth(m).ordersByDay;
    if(ordersChart){ ordersChart.destroy(); }
    ordersChart = new Chart(ctxOrders, {
      type: 'bar',
      data: {
        labels: days,
        datasets: [{
          label: 'Orders',
          data,
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: { legend: { display:false } },
        scales: {
          y: { beginAtZero: true }
        }
      }
    });
  }

  // ====== Best-Selling (pie + list) ======
  const ctxPie = document.getElementById('bestPie');
  let pieChart = null;

  function renderBest(m){
    const best = byMonth(m).best;
    document.getElementById('bestList').innerHTML = best
      .map(b=>`<tr><td>${b.name}</td><td class="text-end">${b.units} unit</td></tr>`).join('');

    if(pieChart){ pieChart.destroy(); }
    pieChart = new Chart(ctxPie, {
      type: 'doughnut',
      data: {
        labels: best.map(b=>b.name),
        datasets: [{ data: best.map(b=>b.units) }]
      },
      options: {
        plugins: { legend: { display:false } },
        cutout: '60%'
      }
    });
  }

  // ====== Top customer ======
  function renderTopCustomer(m){
    const t = byMonth(m).topCustomers;
    document.getElementById('topCustomer').innerHTML = t.map((c,i)=>`
      <li class="d-flex align-items-center justify-content-between border rounded-3 p-2 mb-2">
        <div class="d-flex align-items-center gap-2">
          <span class="badge bg-primary-subtle text-primary">${i+1}</span>
          <div>
            <div class="fw-semibold">${c.name}</div>
            <small class="text-muted">${c.orders} orders</small>
          </div>
        </div>
        <div class="text-end">
          <div class="fw-semibold">${fmtCur(c.spend)}</div>
        </div>
      </li>
    `).join('');
  }

  // ====== Export CSV (simulasi) ======
  document.getElementById('btnExport').addEventListener('click', ()=>{
    const m = Number(document.getElementById('monthSelect').value);
    const k = byMonth(m).kpi;
    const rows = [
      ['Metric','Value'],
      ['Revenue', k.revenue],
      ['Orders', k.orders],
      ['Sold', k.sold],
      ['New Customers', k.customers],
    ];
    const csv = rows.map(r=>r.join(',')).join('\n');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'analytics_export.csv';
    a.click();
    URL.revokeObjectURL(a.href);
  });

  // ====== Month change ======
  document.getElementById('monthSelect').addEventListener('change', (e)=>{
    const m = Number(e.target.value);
    renderKPI(m);
    renderOrdersChart(m);
    renderBest(m);
    renderTopCustomer(m);
  });

  // Init page (default September idx: 8)
  const defaultMonth = Number(document.getElementById('monthSelect').value);
  renderKPI(defaultMonth);
  renderOrdersChart(defaultMonth);
  renderBest(defaultMonth);
  renderTopCustomer(defaultMonth);
})();
</script>
</body>
</html>
